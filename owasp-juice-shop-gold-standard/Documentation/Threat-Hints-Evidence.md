### **Analysis of Threat Evidence by Detection Difficulty**

This document provides a detailed breakdown of the types of hints, evidences, and inferences planted across the six requisite documents. Each of the 30 threats is categorized by the level of difficulty for an automated TM/SDR scanner to detect it based on the nature of its evidence.

---

## ðŸŸ¢ Easy: Explicit Declarations & Known Bad Patterns

These hints are the easiest for an automated tool to identify. They are typically found in structured, machine-readable formats (like IaC or API specs) and involve explicit configurations that match well-known vulnerability patterns. An effective scanner should have a high success rate with these.

| Threat ID | Threat Title                          | Hint / Evidence                                                            | Document Source(s) | Justification for Difficulty Level                                                                                                                |
| :-------- | :------------------------------------ | :------------------------------------------------------------------------- | :----------------- | :------------------------------------------------------------------------------------------------------------------------------------------------ |
| **T-03**  | Unrestricted SSH Ingress              | Unrestricted SSH ingress (`0.0.0.0/0`) in security group.                  | Deployment & IaC   | **Easy:** This is a simple, declarative pattern-matching problem. The tool just needs to parse the IaC file for a known-bad configuration string. |
| **T-04**  | Overly Permissive IAM Role            | Overly permissive IAM role (`s3:*` on `*`).                                | Deployment & IaC   | **Easy:** This is a declarative statement in a structured file. The tool can easily parse the policy and identify the wildcard permissions.       |
| **T-13**  | Weak Credential Storage               | Use of `MD5` with a static salt for password hashing is explicitly stated. | Auth & Authz Model | **Easy:** The term "MD5" is a high-confidence keyword that any security tool should be programmed to flag as a critical weakness.                 |
| **T-15**  | Insecure Data Storage in S3           | S3 bucket Access Control List (ACL) is explicitly set to `"public-read"`.  | Deployment & IaC   | **Easy:** This is another declarative, known-bad configuration that is trivial for an IaC-aware scanner to detect.                                |
| **T-24**  | Unrestricted Application Port Ingress | Unrestricted application port ingress (`0.0.0.0/0` on port 3000).          | Deployment & IaC   | **Easy:** This is identical in nature to the SSH ingress rule; a simple pattern match in a structured file.                                       |

---

## ðŸŸ¡ Moderate: Context-Aware Keywords & Flawed Design Patterns

These hints require the tool to do more than just match a simple pattern. It needs to parse natural language for specific keywords *in context* or recognize a sequence of steps in a data flow diagram that represents a flawed design pattern.

| Threat ID | Threat Title                                | Hint / Evidence                                                                                                               | Document Source(s)            | Justification for Difficulty Level                                                                                                                                                                            |
| :-------- | :------------------------------------------ | :---------------------------------------------------------------------------------------------------------------------------- | :---------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **T-02**  | Data Exfiltration via SQL Injection         | DFD shows a raw SQL query being constructed with user input (`LIKE '%<term>%`).                                               | Architecture & DFDs           | **Moderate:** The tool must parse a diagram's text, identify the SQL syntax, and recognize that the `<term>` variable is being concatenated unsafely.                                                         |
| **T-07**  | Server-Side Request Forgery (SSRF)          | An API endpoint takes a URL to fetch a remote profile picture, and the DFD shows the server making a direct outbound request. | API Spec, Architecture & DFDs | **Moderate:** The tool must connect an API accepting a URL with a data flow showing an outbound request, recognizing this specific *pattern* as a potential SSRF vulnerability.                               |
| **T-08**  | Local File Read via Directory Traversal     | An API endpoint (`/ftp/{filename}`) and a description of serving log files from a directory.                                  | API Spec, Architecture & DFDs | **Moderate:** Requires the tool to infer risk from a functional description. It must understand that an application reading files based on user input is a pattern that can lead to directory traversal.      |
| **T-09**  | Sensitive Info Disclosure via XXE           | A DFD note states the XML parser "must process external entities," and the API spec confirms the endpoint accepts XML.        | Architecture & DFDs, API Spec | **Moderate:** The tool needs to parse a natural language sentence for the phrase "process external entities" and understand its critical security implication when associated with an XML-accepting endpoint. |
| **T-11**  | Supply Chain Risk from Unpinned Base Images | `user_data` script in IaC uses the `:latest` tag to run a Docker container.                                                   | Deployment & IaC              | **Moderate:** Requires the scanner to parse a shell script embedded within the IaC and recognize the `:latest` tag as a supply chain risk.                                                                    |
| **T-12**  | Broken Access Control in Basket             | API for viewing a basket is `GET /rest/basket/{basketId}`, with the ID coming directly from the URL.                          | API Spec, Architecture & DFDs | **Moderate:** The tool must recognize the Insecure Direct Object Reference (IDOR) pattern: a resource ID is taken from a user-controllable location (URL path).                                               |
| **T-16**  | Unvalidated Redirects                       | A `GET /rest/redirect` endpoint takes a `to` parameter from the query string to redirect users to an external URL.            | API Spec                      | **Moderate:** The tool needs to recognize the open redirect pattern: an endpoint takes a full URL as a parameter and performs a redirection.                                                                  |
| **T-20**  | Denial of Service via Injection             | Injection points for SQLi and XXE are documented.                                                                             | Architecture & DFDs           | **Moderate:** The tool must infer a secondary risk (Denial of Service) from a primary vulnerability pattern (Injection). This requires a deeper knowledge graph.                                              |
| **T-21**  | Security Through Obscurity                  | The admin section is located at a "non-obvious URL" (`/administration`).                                                      | User Stories                  | **Moderate:** Requires NLP to understand that "non-obvious URL" is a synonym for "security through obscurity," a documented design weakness.                                                                  |
| **T-22**  | Weak Password Recovery                      | Password reset is handled by answering a security question.                                                                   | PRD, User Stories             | **Moderate:** The tool must be trained to recognize "security questions" as a known weak password recovery mechanism.                                                                                         |
| **T-23**  | Bypass of Anti-Automation Controls          | A custom-built mathematical CAPTCHA is described for the feedback form.                                                       | API Spec                      | **Moderate:** The tool needs to identify the term "mathematical CAPTCHA" and classify it as a weak, bypassable anti-automation control.                                                                       |
| **T-25**  | Lack of MFA Enforcement for IAM             | The deployment architecture mentions IAM password policies but makes no mention of enforcing MFA.                             | Deployment & IaC              | **Moderate:** This requires the tool to check for the *absence* of a critical control (MFA) when a related context (IAM policies) is mentioned.                                                               |
| **T-27**  | Username Tampering in Feedback              | The API for feedback submission includes an optional `UserId` field that can be submitted by the client.                      | API Spec, User Stories        | **Moderate:** The tool must recognize that allowing a user to submit an identifier for another user in an API call is a classic pattern for tampering.                                                        |
| **T-29**  | Information Disclosure in Errors            | The documents lack any requirements for sanitized or generic error handling.                                                  | PRD, API Spec                 | **Moderate:** Similar to T-25, this requires detecting the absence of a standard security control (secure error handling) across multiple documents.                                                          |

---

## ðŸ”´ Hard: Chained Logic, Business Context & Inferred Risks

These are the most difficult hints for an automated tool to identify. They require chaining evidence across multiple documents, understanding nuanced business logic described in natural language, or inferring a security risk from the *absence* of a specified control.

| Threat ID | Threat Title                                   | Hint / Evidence                                                                                                                      | Document Source(s)           | Justification for Difficulty Level                                                                                                                                                                                                                                |
| :-------- | :--------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------- | :--------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **T-01**  | RCE via Insecure Deserialization               | A requirement to use a "YAML parsing library" for B2B data ingestion is mentioned.                                                   | PRD                          | **Hard:** The tool must connect a generic requirement for a "YAML library" to the specific, high-impact risk of insecure deserialization, a link that is not explicit.                                                                                            |
| **T-05**  | Arbitrary File Upload/Write                    | The user stories specify the use of a particular library version: `express-fileupload` version `1.1.7-alpha.3`.                      | User Stories                 | **Hard:** To find this, a tool would need to perform Software Composition Analysis (SCA) on natural language text, extract the library name and version, and check it against a vulnerability database.                                                           |
| **T-06**  | Persistent Cross-Site Scripting (XSS)          | A technical note says to "render basic user-supplied HTML formatting" for reviews.                                                   | User Stories                 | **Hard:** Requires deep semantic understanding. The tool must interpret a "feature" described in natural language ("richer user experience") as a critical security flaw (Persistent XSS).                                                                        |
| **T-10**  | Privilege Escalation via Insecure Registration | The API spec shows the `role` field is `readOnly` in the `User` schema response, but the `Auth Model` shows `admin` is a valid role. | API Spec, Auth & Authz Model | **Hard:** The tool must chain two pieces of information: a valid, high-privilege role exists, and the API documentation doesn't explicitly prevent a user from submitting this parameter during registration. It must infer the risk of a mass assignment attack. |
| **T-14**  | Business Logic Flaw in Coupon Generation       | A technical note in the user stories describes a **client-side, predictable formula** for generating coupon codes.                   | User Stories                 | **Hard:** Requires deep semantic understanding of natural language. The tool must comprehend the concept of a "predictable formula" and infer that a client-side implementation represents a business logic flaw that could lead to financial fraud.              |
| **T-17**  | Outdated Libraries with Known Vulns            | Specific libraries (`express-fileupload: 1.1.7-alpha.3`, `ngx-colors-picker`) are named in the requirements.                         | User Stories, PRD            | **Hard:** Similar to T-05, this requires the tool to extract multiple library names from natural language text and check them against a vulnerability database.                                                                                                   |
| **T-18**  | Container Escalation Risk                      | The `user_data` script does not specify a `USER` instruction for its Docker commands.                                                | Deployment & IaC             | **Hard:** The tool must infer a security risk (container running as root) from the *absence* of a specific security instruction within an embedded shell script in an IaC file.                                                                                   |
| **T-19**  | Hardcoded Secrets Risk in CI/CD                | Secrets are managed in a `.tfvars` file checked into a separate Git repository.                                                      | Deployment & IaC             | **Hard:** The tool needs to understand the context of a CI/CD pipeline and recognize that storing secrets in any Git repository, even a private one, is a significant operational risk.                                                                           |
| **T-26**  | Race Condition in "Like" Functionality         | A user story describes an "optimistic UI update" with an "asynchronous" background request for the "like" button.                    | User Stories                 | **Hard:** This requires the tool to understand a nuanced software design pattern ("optimistic UI") described in natural language and correctly infer that this specific pattern is often susceptible to race conditions.                                          |
| **T-28**  | Auth Bypass via JWT Signature Forgery          | The `Auth Model` specifies the JWT signing algorithm (`RS256`) but provides no details on key management or signature validation.    | Auth & Authz Model           | **Hard:** Requires the tool to infer a high-impact risk (JWT signature forgery) from the *absence* of specific security controls in the design document.                                                                                                          |
| **T-30**  | Frontend Dependency Typosquatting              | The PRD explicitly names a third-party library: `ngx-colors-picker`.                                                                 | PRD                          | **Hard:** The tool must infer a supply chain risk (typosquatting) from a functional requirement. It needs to understand that specifying *any* third-party package introduces this type of risk.                                                                   |

---
